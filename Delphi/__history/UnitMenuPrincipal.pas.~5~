unit UnitMenuPrincipal;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, FireDAC.Stan.Intf, FireDAC.Stan.Option,
  FireDAC.Stan.Param, FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf,
  FireDAC.DApt.Intf, FireDAC.Stan.Async, FireDAC.DApt, Vcl.ExtCtrls,
  Vcl.ComCtrls, Vcl.ToolWin, Vcl.ActnMan, Vcl.ActnCtrls, Vcl.Ribbon, Data.DB,
  FireDAC.Comp.DataSet, FireDAC.Comp.Client, System.Actions, Vcl.ActnList,
  Vcl.RibbonLunaStyleActnCtrls;

type
  TFrmMenuPrincipal = class(TForm)
    ActionManager1: TActionManager;
    Action2: TAction;
    Action3: TAction;
    Action4: TAction;
    Action5: TAction;
    Action6: TAction;
    Action7: TAction;
    Action8: TAction;
    Action9: TAction;
    Action10: TAction;
    Action11: TAction;
    Action12: TAction;
    QueryLogin: TFDQuery;
    QueryLoginCodigo: TFDAutoIncField;
    QueryLoginUsuario: TStringField;
    QueryLoginSenha: TStringField;
    QueryLoginFuncionario: TIntegerField;
    QueryLoginStatus: TStringField;
    QueryLoginPerfil: TIntegerField;
    QueryLoginCodigo_1: TFDAutoIncField;
    QueryLoginDescricao: TStringField;
    QueryLoginOcultar: TStringField;
    QueryLoginUsuario_1: TStringField;
    QueryLoginUsuarioI: TStringField;
    QueryLoginUsuarioA: TStringField;
    QueryLoginUsuarioE: TStringField;
    QueryLoginPerfil_1: TStringField;
    QueryLoginPerfilI: TStringField;
    QueryLoginPerfilA: TStringField;
    QueryLoginPerfilE: TStringField;
    QueryLoginVenda: TStringField;
    QueryLoginVendaI: TStringField;
    QueryLoginVendaA: TStringField;
    QueryLoginVendaE: TStringField;
    QueryLoginStatus_1: TStringField;
    Ribbon1: TRibbon;
    RibbonPage1: TRibbonPage;
    RibbonGroup3: TRibbonGroup;
    RibbonGroup4: TRibbonGroup;
    RibbonGroup5: TRibbonGroup;
    RibbonGroup6: TRibbonGroup;
    RibbonGroup7: TRibbonGroup;
    RibbonGroup8: TRibbonGroup;
    RibbonPage2: TRibbonPage;
    RibbonGroup9: TRibbonGroup;
    RibbonPage3: TRibbonPage;
    RibbonPage4: TRibbonPage;
    RibbonPage5: TRibbonPage;
    RibbonGroup1: TRibbonGroup;
    RibbonGroup10: TRibbonGroup;
    StatusBar1: TStatusBar;
    Timer1: TTimer;
    Action13: TAction;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormCloseQuery(Sender: TObject; var CanClose: Boolean);
    procedure Timer1Timer(Sender: TObject);
    procedure FormActivate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FrmMenuPrincipal: TFrmMenuPrincipal;

implementation

{$R *.dfm}

uses UnitDM;

procedure TFrmMenuPrincipal.FormActivate(Sender: TObject);
begin
  WindowState := wsMaximized;
  StatusBar1.Panels[1].Text := FormatDateTime(' dddd ", " dd " de " mmmm " de " yyyy', Now);
end;

procedure TFrmMenuPrincipal.FormClose(Sender: TObject;
  var Action: TCloseAction);
begin
  Close;
end;

procedure TFrmMenuPrincipal.FormCloseQuery(Sender: TObject;
  var CanClose: Boolean);
begin
  confSaida := Application.MessageBox('Tem certeza que deseja sair do sistema?', 'Atenção', MB_YESNO + MB_DEFBUTTON2 + MB_ICONQUESTION);
  if confSaida = IDYES then
    Application.Terminate
  else
    CanClose := False;
end;

procedure TFrmMenuPrincipal.Timer1Timer(Sender: TObject);
begin
  StatusBar1.Panels[0].Text := TimeToStr(Time);
end;

end.
